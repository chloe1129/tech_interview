## What is OSI 7 Layer?

OSI 7 계층은 네트웨크에서 통신이 일어나는 과정을 7단계로 나눈 것
개방형 시스템 상호 연결의 표준

> 7계층으로 나눈 이유는?

    통신이 일어나는 과정을 단계별로 파악할 수 있기 때문이다.

    흐름을 한눈에 알아보기 쉽다.
    7단계 중 특정한 곳에 이상이 생기면 다른 단계의 장비 및 소프트웨어를 건들이지 않고도 이상이 생긴 단계만 고칠 수 있다.

<img src= "../IMG/osi_7_layer.png" width="600px"></img>

> 작동 원리

    1. 전송 시 7계층에서 1계층으로 각각의 층마다 인식할 수 있어야 하는 헤더를 붙임(캡슐화)
    2. 수신 시 1계층에서 7계층으로 헤더를 떼어냄(디캡슐화)
    3. 출발지에서 데이터가 전송될 때 헤더가 추가 되는데 2계층에서만 오류제어를 위해 꼬리 부분에 추가됨
    4. 물리 계층에서 1,0의 신호가 되어 전송 매체(동축 케이블, 광섬유 등)을 통해 전송

#### 1. 1계층, 물리계층(Physical Layer)

    실제 장치를 연결하기 위한 전기적 및 물리적 세부 사항을 정의한 계층
    인터넷 케이블, 라우터 스의치 등의 전기적 신호가 물리적인 장치에 의해 통신하는 계층
    통신단위는 비트이고 비트는 1과 0, 전기적으로 on, off 상태

    데이터를 전달만 할뿐 알고리즘, 오류제어 기능이 없음
    데이터를 전기적인 신호로 변환해 주고받는 기능만
    (통신케이블, 리피터, 허브 등)

#### 2. 2계층, 데이터 링크계층(DataLink Layer)

    장치 간 신호를 전달하는 물리계층을 이용해 네트워크 상의 주변 장치들 간의 데이터를 전송하는 역할.
    물리계층을 통해 송수신되는 정보의 오류와 흐름을 관리해 안전한(오류, 재전송의 기능) 정보의 전달을 수행하도록 도와주는 역할
    통신에서의 오류를 찾거나 재전송하는 기능이 있고 Mac 주소를 이용해 통신한다.

    MAC(Media Access Control Address: 네트워크 세그먼트의 데이터 링크 계층에서 통신을 위한 네트워크 인터페이서에 할당된 고유 ID) 주소를 가지고 통신을 하는데 전송되는 단위를 프레임이라고 한다.

    두 장치 간의 신뢰성있는 전송을 보장하기 위한 계층.
    데이터 링크 게층에서 전송되는 단위는 프레임

    주소 할당: 물리 계층으로부터 받은 신호들이 네트워크 상의 장치에 올바르게 안착할 수 있게 한다.
    오류 감지: 신호가 전달되는 동안 오류가 포함되는지 감지, 오류가 있다면 해당 데이터를 폐기

#### 3. 3계층, 네트워크 계층(Network Layer)

    중계 노드를 통해 전송하는 경우 어떻게 중계할 것인가를 규정
    라우팅 기능을 맡고 있는 계층으로 목적지까지 가장 안전하고 빠르게 데이터를 보내는 기능(최적의 경로 설정 가능)
    컴퓨터에게 데이터를 전송할 주소를 갖고 있어 통신(인터넷)이 가능
    논리적인 주소 구조(IP주소: 네트워크 계층 헤더에 속함), 곧 네트워크 관리자가 직접 주소를 할당하며 계층적
    데이터 단위는 패킷(Packet)

    네트워크 계층은 라우팅, 흐름 제어, 세그멘테이션, 오류 제어, 인터네트워킹 등을 수행
    라우터가 이 계층에서 동작하고 이 계층에서 동작하는 스위치도 있다.

#### 4. 4계층, 전송 계층(Transport Layer)

    통신을 활성화하기 위한 계층이며 보통 TCP 프로토콜을 이용
    데이터 전송을 위한 port 번호를 사용, 포트를 열어서 응용 프로그램들이 전송을 할 수 있게 함
    데이터가 왔아면 4계층에서 해당 데이터를 하나로 통합하여 5계층으로 전달
    전송 단위는 세그먼트(segment)

    양끝단의 사용자가 신뢰성 있는 데이터를 주고받게 하여 상위 계층이 데이터 전달의 유효성이나 효율성을 신경쓰지 않게 해주는 계층
    시퀀스 넘버 기반의 오류 제어 방식을 사용
    전송 계층이 패킷들의 전송이 유효한지 확인하고 전송 실패한 패킷들을 다시 전송한다는 것을 뜻함

    end to end 통신을 다루는 최하위 계층으로 종단 간 신뢰성 있고 효율적인 데이터를 전송
    오류검출 및 복구와 흐름 제어, 중복 검사 등을 수행

<br>

> 3-웨이 핸드셰이킹(3-Way Handshaking)

<img src= "../IMG/3-way.png" width="500px"></img>

    1.  1단계

    - 두 시스템이 통신을 하기 전에 클라이언트는 포트가 닫힌 closed 상태
    - 서버는 해당 포트로 항상 서비스를 제공할 수 있는 listen 상태

    2.  2단계

        - 클라이언트가 처음 통신을 하려면 임의의 포트 번호가 클라이언트 프로그램에 할당되고, - 클라이언트는 서버에 연결하고 싶다는 의사 표시로 SYN Sent 상태가 된다.

    3.  3단계

        - 클라이언트의 연결 요청을 받은 서버는 SYN Received 상태가 되고, 클라이언트에 연결을 해도 좋다는 의미로 SYN + ACK 패킷을 보낸다.

    4.  4단계

        - 클라이언트는 연결 요청에 대한 서버의 응답을 확인했다는 표시로 ACK 패킷을 서버로 보냄

<br>

> TCP 연결 해제 과정

<img src= "../IMG/tcp_disconnect.png" width="500px"></img>

    1.  1단계

        - 통신 중에는 클라이언트와 서버 모두 Established 상태

    2.  2단계

        - 통신을 끊으려는 클라이언트가 서버에 FIN 패킷을 보내고 클라이언트는 Close Wait 상태가 된다.

    3.  3단계

        - 서버는 클라이언트의 연결 종료 요청을 확인하고 응답으로 클라이언트에 ACK 패킷을 보내면 서버도 클라이언트의 연결을 종료하겠다는 의미로 FIN 패킷을 보내고 Close Wait 상태가 된다.

    4.  4단계
        - 클라이언트는 연결 종료를 요청한 것에 대한 서버의 응답을 확인했다는 표시로 ACK 패킷을 서버에 보낸다.

<br>

#### 5. 5계층, 세션 계층(Session Layer)

    양 끝단의 응용 프로세스가 통신을 관리하는 방법을 제공하는 계층
    이 계층의 프로토콜은 통신 연결이 손실되는 경우 연결 복구 시도가 가능하며 연결 시도중 장시간 연결이 되지 않았다며 세션 계층의 프로토콜이 연결을 닫고 다시 연결을 시도

    전이중 통신, 반이중 통신 명령 중 하나를 제공하여 교환 메세지 스트림(컴퓨터 처리 환경에서 시간이 지남에 따라 사용할 수 있게 되는 일련의 데이터 요소를 가리키는 수많은 방식) 내에서 동기화 지점을 제동

    - 전이중 통신(Full Duplex)
        두 대의 단말기가 데이터를 송수신하기 위해 동시에 각각 독립된 회선을 사용하는 통신 방식
        ex. 전화망, 고속 데이터 통신

    - 반이중 통신(Half Duplex)
        한쪽이 송신하는 동안 다른 쪽에서 수신하는 통신 방식으로 전송 방향을 교체
        ex. 마스터 슬레이브 방식의 센서 네트워크

#### 6. 6계층, 표현 계층(Presentation Layer)

    코드 간 번역을 담당하는 계층
    사용자 시스템에서 데이터의 형식상 차이를 다루는 부담을 응용 계층으로부터 덜어주고 MIME(전자 우편을 위한 인터넷 표준 포맷) 인코딩이나 암호화 등의 동작이 이 계층에서 이루어진다
    데이터의 표현에서 독립적인 부분을 나타내고 일반적으로 응용프로그램 형식을 준비 또는 네트워크 형식으로 변환하거나 네트워크 형식을 응용 프로그램 형식으로 변환하는 것을 나타낸다.

    응용 프로그램이나 네트워크를 위해 데이터를 " 표현  "
    1. 송신자에서 온 데이터를 해석하기 위한 응용 계층 데이터 부호화,변화
    2. 수신자에서 데이터의 압축을 풀수 있는 방식으로 된 데이터 압축
    3. 데이터 암호화와 복호화
    ex. EBCIDIC(확장 이진화 십진법 교환 부호)로 인코딩된 문서 파일을 ASCII로 인코딩 된 파일로 바꿔주는 것,
    해당 데이터가 TEXT인지, 그림인지, GIF인지, JPG인지의 구분하는 것

#### 7. 7계층, 응용 프로그램 계층(Application Layer)

    응용 프로세스와 직접 관계하여 일반적인 응용 서비스를 수행하는 계층
    최상위 계층으로 사용자에게 직접적으로 보이는 부분이며 OSI 모형에서 최종 사용자에게 가장 가까운 계층
    웹 상에서 웹 서버 및 웹브라우저 상호 간의 데이터 전송을 위한 응용계층 프로토콜 처음에는 WWW 상의 하이퍼텍스트 형태의 문서를 전달하는데 주로 이용했고 현재는 이미지, 비디오, 음성 등 대부분의 모든 데이터 전송이 가능

    7계층에서 작송하는 응용 프로그램은 사용자와 직접적으로 상호작응
    ex. 웹 브라우저: Chrome, Firefox 등, 응용 프로그램: Skype, Office 등

> 데이터 통신을 설명할 때 OSI 참조 모델을 사용할 수 있다.

    OSI 참조 모델은 데이터 통신을 7단계로 나누고 이 단계를 계층(layer)라고 부른다.
    각 계층마다 각 계층의 역할을 하는 `프로토콜`이 존재한다.
    각 계층은 독립해있고 하위 계층은 상위 계층을 위해 일하고 상위 계층은 하위에 관여하지 않는다.

> 프로토콜

    통신하기 위한 기술적 약속들, 데이터를 송수신하는 순서와 내용을 결정한다.
    HTTP, TCP/IP, UDP 모두 프로토콜이다.
    현대 internet Protocoldms 보통 layering 되어있다. 상위 계층은 하위 계층의 protocol을 이용해 새로운 protocol을 수립한다.
    프로토콜군은 각각의 계층에서 사용되는 프로토콜을 통합한 것으로 가장 많이 사용되는 것이 TCP/IP 프로토콜군이다.
